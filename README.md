# SPAM (Smart Proxy Alb Manager)
CLI Tool to manage AWS ALB Target Groups and Rules for a Single Listner to setup Foreman Smart Proxies in bulk

<!-- TOC depthFrom:1 depthTo:6 withLinks:1 updateOnSave:1 orderedList:0 -->

- [SPAM (Smart Proxy Alb Manager)](#spam-smart-proxy-alb-manager)
	- [Prerequisites](#prerequisites)
	- [Info](#info)
		- [Is It For Me?](#is-it-for-me)
		- [What Does it Do?](#what-does-it-do)
	- [Usage](#usage)
		- [Install](#install)
			- [Global Install](#global-install)
			- [Local Install](#local-install)
		- [Config](#config)
- [Optional Settings](#optional-settings)
		- [Commands](#commands)
			- [Chef](#chef)
				- [Commands](#commands)
				- [Flags/Options](#flagsoptions)
	- [Development](#development)
	- [How to Contribute](#how-to-contribute)
		- [External Contributors](#external-contributors)
		- [Internal Contributors](#internal-contributors)

<!-- /TOC -->

## Prerequisites

-   Ruby 2.3 or later
-   Docker 1.12 or later
-   Bundler

## Info

### Is It For Me?
SPAM is a CLI Tool to support The Foreman Smart Proxies and Plugins for the following type of situations
-   Chef Users
    -   Multi-Chef Orgs that need a smart proxy each
    -   Mutli-Chef Orgs that match Foreman Organizations and need Smart Proxies for each Chef Org, under each Foreman Org

### What Does it Do?
SPAM Wraps the Docker API, AWS API, and Foreman API so it can act as the glue or coordinator between these services to create smart proxies in bulk, each step is optional and can be modified
1. Creates Docker Service in

## Usage

### Install

#### Global Install

Run the following

```bash
gem install bundler
bundle install
```
#### Local Install

```bash
gem install bundler
bundle install --path vendor/bundle
```
### Config
Any [flag/option](#flags_options) can be configured via YAML for options that won't change

**NOTE**: Only recommended settings are show below, things like org, port, priority, tagets should be dynamic

`~/.spam/config./yml`
```yaml
---
vpc: VPC
listener_arn: ARN
foreman_user: USER
foreman_password: PASSWORD
proxy_url: https://proxy.domain.com
# Optional Settings
aws_region: REGION
protocol: HTTP
```

### Commands

Commands to interact with Docker, AWS ALB, and The Foreman

**NOTE**: Chef is the only support Smart Proxy setup currently, as we expand our integrations and services we will add more to the tool. Pull Request always welcome!

#### Chef

##### Commands

| Command |                                        Description                                         |
| ------- | ------------------------------------------------------------------------------------------ |
| Create  | Creates the Chef Org Proxy on Dockerhost, ALB Rules/Paths, and adds Smart Proxy to Foreman |
| Delete  | Deletes all items generated by Create Command                                              |
| Add     | Command to add targets to specific Org Configuration                                       |
| List    | List current SPAM Configs/Orgs                                                             |

##### Flags/Options

| Arg | Description |
| --- | ----------- |
|     |             |

## Development

## How to Contribute

### External Contributors

-   Fork the repo on [Github](https://github.com/HearstAT/SPAM)
-   Clone the project to your own machine
-   Commit changes to your own branch
-   Push your work back up to your fork
-   Submit a Pull Request so that we can review your changes

**NOTE**: Be sure to merge the latest from "upstream" before making a pull request!

### Internal Contributors

-   Clone the project to your own machine
-   Create a new branch from master
-   Commit changes to your own branch
-   Push your work back up to your branch
-   Submit a Pull Request so the changes can be reviewed

**NOTE**: Be sure to merge the latest from "upstream" before making a pull request!
